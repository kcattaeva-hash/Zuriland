<!DOCTYPE html>
<html>
<head>
  <title>–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 10px 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 4px;
      font-weight: bold;
      margin-left: 10px;
    }
    .status.ok {
      background: #4ade80;
      color: white;
    }
    .status.error {
      background: #ef4444;
      color: white;
    }
    button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #2563eb;
    }
    .result {
      background: #f0f0f0;
      padding: 10px;
      margin-top: 10px;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏</h1>
  
  <div class="test-section">
    <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage</h2>
    <button onclick="testLocalStorage()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage</button>
    <button onclick="clearLocalStorage()">–û—á–∏—Å—Ç–∏—Ç—å localStorage</button>
    <div id="localStorage-result" class="result"></div>
  </div>

  <div class="test-section">
    <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
    <button onclick="testData()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö</button>
    <button onclick="addTestData()">–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
    <div id="data-result" class="result"></div>
  </div>

  <div class="test-section">
    <h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–æ–ª–∏</h2>
    <button onclick="testConsole()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏</button>
    <div id="console-result" class="result"></div>
    <p><small>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</small></p>
  </div>

  <div class="test-section">
    <h2>4. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</h2>
    <button onclick="showCurrentState()">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>
    <div id="state-result" class="result"></div>
  </div>

  <script>
    function testLocalStorage() {
      const result = document.getElementById('localStorage-result');
      try {
        localStorage.setItem('test', 'works');
        const value = localStorage.getItem('test');
        localStorage.removeItem('test');
        
        if (value === 'works') {
          result.innerHTML = '‚úÖ localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ';
          result.style.color = 'green';
        } else {
          result.innerHTML = '‚ùå localStorage –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ';
          result.style.color = 'red';
        }
      } catch (e) {
        result.innerHTML = '‚ùå –û—à–∏–±–∫–∞: ' + e.message;
        result.style.color = 'red';
      }
    }

    function clearLocalStorage() {
      localStorage.removeItem('students');
      localStorage.removeItem('payments');
      document.getElementById('localStorage-result').innerHTML = 'üóëÔ∏è localStorage –æ—á–∏—â–µ–Ω';
      document.getElementById('localStorage-result').style.color = 'orange';
    }

    function testData() {
      const result = document.getElementById('data-result');
      try {
        const students = JSON.parse(localStorage.getItem('students') || '[]');
        const payments = JSON.parse(localStorage.getItem('payments') || '[]');
        
        result.innerHTML = `
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –ö–ª–∏–µ–Ω—Ç–æ–≤: ${students.length}
- –ü–ª–∞—Ç–µ–∂–µ–π: ${payments.length}

${students.length > 0 ? '\n‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–∞–π–¥–µ–Ω—ã' : '\n‚ö†Ô∏è –î–∞–Ω–Ω—ã—Ö –Ω–µ—Ç'}
        `;
        result.style.color = students.length > 0 ? 'green' : 'orange';
      } catch (e) {
        result.innerHTML = '‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: ' + e.message;
        result.style.color = 'red';
      }
    }

    function addTestData() {
      const testStudent = {
        id: Date.now().toString(),
        name: '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á',
        phone: '+7 (999) 123-45-67',
        productName: '–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ Samsung',
        debtAmount: 50000,
        paidAmount: 10000,
        paymentDate: new Date().toISOString(),
        nextPaymentDate: '15.12.2025'
      };

      const testPayment = {
        id: Date.now().toString() + '-payment',
        studentId: testStudent.id,
        amount: 10000,
        date: new Date().toISOString(),
        note: '–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂'
      };

      const students = JSON.parse(localStorage.getItem('students') || '[]');
      const payments = JSON.parse(localStorage.getItem('payments') || '[]');

      students.push(testStudent);
      payments.push(testPayment);

      localStorage.setItem('students', JSON.stringify(students));
      localStorage.setItem('payments', JSON.stringify(payments));

      document.getElementById('data-result').innerHTML = '‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã!';
      document.getElementById('data-result').style.color = 'green';
    }

    function testConsole() {
      const result = document.getElementById('console-result');
      result.innerHTML = `
üìù –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ:
- ‚ùå –ö—Ä–∞—Å–Ω—ã—Ö –æ—à–∏–±–æ–∫
- ‚ö†Ô∏è –ñ—ë–ª—Ç—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- üîµ –°–∏–Ω–∏—Ö –ª–æ–≥–æ–≤

–ù–∞–∂–º–∏—Ç–µ F12 –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Å–æ–ª–∏
      `;
    }

    function showCurrentState() {
      const result = document.getElementById('state-result');
      try {
        const students = JSON.parse(localStorage.getItem('students') || '[]');
        const payments = JSON.parse(localStorage.getItem('payments') || '[]');

        if (students.length === 0) {
          result.innerHTML = '‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.';
          result.style.color = 'orange';
          return;
        }

        let output = 'üìã –ö–õ–ò–ï–ù–¢–´:\n\n';
        students.forEach(s => {
          const debt = s.debtAmount - s.paidAmount;
          output += `üë§ ${s.name}\n`;
          output += `   üì¶ –¢–æ–≤–∞—Ä: ${s.productName}\n`;
          output += `   üí∞ –î–æ–ª–≥: ${s.debtAmount} ‚ÇΩ\n`;
          output += `   ‚úÖ –û–ø–ª–∞—á–µ–Ω–æ: ${s.paidAmount} ‚ÇΩ\n`;
          output += `   üìä –û—Å—Ç–∞—Ç–æ–∫: ${debt} ‚ÇΩ\n`;
          output += `   üìÖ –°–ª–µ–¥. –ø–ª–∞—Ç—ë–∂: ${s.nextPaymentDate || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}\n\n`;
        });

        output += '\nüí≥ –ü–õ–ê–¢–ï–ñ–ò:\n\n';
        if (payments.length === 0) {
          output += '   –ù–µ—Ç –ø–ª–∞—Ç–µ–∂–µ–π\n';
        } else {
          payments.forEach(p => {
            const student = students.find(s => s.id === p.studentId);
            output += `üíµ ${p.amount} ‚ÇΩ - ${student?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'}\n`;
            output += `   üìÖ ${new Date(p.date).toLocaleString('ru-RU')}\n`;
            output += `   üìù ${p.note}\n\n`;
          });
        }

        result.innerHTML = output;
        result.style.color = 'black';
      } catch (e) {
        result.innerHTML = '‚ùå –û—à–∏–±–∫–∞: ' + e.message;
        result.style.color = 'red';
      }
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.onload = function() {
      testLocalStorage();
      testData();
    };
  </script>
</body>
</html>
